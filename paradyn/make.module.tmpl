#
# Common makefile template for paradyn.  This file is not intended to
# be a useful Makefile in isolation; instead, it should be included
# from within an architecture-specific Makefile.
#
# $Log: make.module.tmpl,v $
# Revision 1.30  1998/02/05 22:19:00  czhang
# Removed the rule for "metTester", which was used for building a stand-alone
# test for the MDL scanner and parser.  Two of the source files for the test
# "metTester.C" and "metTemplates.C" were removed because they were obsolete.
#
# Revision 1.29  1996/05/12 04:41:20  tamches
# added templatesUIWASHG.C (split off from templatesUI.C), since our
# aix 4.1 machines barfed when assembling what was templatesUI.C
#
# Revision 1.28  1996/05/02 19:51:39  karavan
# added new cost server class, two new files, PCcostServer.C and PCcostServer.h
#
# Revision 1.27  1996/02/27 17:30:40  karavan
# removed PC debug printing flag
#
# Revision 1.26  1996/02/22 18:34:23  karavan
#  obsoleted PCdataQ.C
#
# Revision 1.25  1996/02/11 18:20:47  tamches
# templatesDMPCV.C to templatesDM.C
#
# Revision 1.24  1996/02/07 00:05:27  tamches
# added templatesPCV.C
#
# Revision 1.23  1996/02/06 16:27:43  mjrg
# Invoke tcl2c with perl, to avoid problems on HP.
#

CFLAGS		+= $(TCLFRIENDLYWARNINGS)
#CXXFLAGS	+= $(TCLFRIENDLYWARNINGS) -DPCDEBUG
CXXFLAGS	+= $(TCLFRIENDLYWARNINGS) 
TFLAGS		+= $(TCLFRIENDLYWARNINGS)

TARGET	      = paradyn

VPATH	     += ../h:$(wildcard ../src/*thread):\
                ../src/pdMain:../src/met

# We don't want to force the user to have "visi" checked out in order
# to compile paradyn:
VPATH	+= $(shell if [ -d $(TO_CORE)/visi ]; then echo ":../../visi/h"; else echo ":/p/paradyn/core/visi/h"; fi )

SRCS	     += ../src/DMthread/DMpublic.C \
		../src/DMthread/DMdaemon.C \
		../src/DMthread/DMmetric.C \
		../src/DMthread/DMmain.C \
		../src/DMthread/DMperfstream.C \
		../src/DMthread/DMresource.C \
		../src/DMthread/DMabstractions.C \
		../src/DMthread/DMcritPath.C \
		../src/DMthread/DMphase.C \
		../src/pdMain/main.C \
		../src/VMthread/VMmain.C \
		../src/VISIthread/VISIthreadmain.C \
		../src/VISIthread/VISIthreadpublic.C \
		../src/PCthread/PCdata.C \
		../src/PCthread/PCfocus.C \
		../src/PCthread/PCsearch.C \
		../src/PCthread/PCpublic.C \
		../src/PCthread/PCmain.C \
		../src/PCthread/PCconstants.C \
		../src/PCthread/PCfilter.C \
		../src/PCthread/PCmetric.C \
		../src/PCthread/PCwhy.C \
		../src/PCthread/PCexperiment.C \
		../src/PCthread/PCrules.C \
		../src/PCthread/PCshg.C \
		../src/PCthread/PCmetricInst.C \
		../src/PCthread/PCcostServer.C \
		../src/UIthread/tclTunable.C \
		../src/UIthread/Status.C \
		../src/UIthread/uimpd.tcl.C \
		../src/UIthread/UImain.C \
		../src/UIthread/UIpublic.C \
		../src/UIthread/UIwhere.C \
		../src/UIthread/paradyn.tcl.C \
		../src/UIthread/whereAxis.C \
		../src/UIthread/abstractions.C \
		../src/UIthread/where4treeConstants.C \
		../src/UIthread/rootNode.C \
		../src/UIthread/scrollbar.C \
		../src/UIthread/whereAxisTcl.C \
		../src/UIthread/shg.C \
		../src/UIthread/shgRootNode.C \
		../src/UIthread/shgPhases.C \
		../src/UIthread/shgConsts.C \
		../src/UIthread/shgTcl.C \
		../src/UIthread/tkTools.C \
		../src/UIthread/pdLogo.C \
		../src/TCthread/TCmain.C \
		../src/TCthread/tunableConst.C \
		../src/met/metMain.C \
		metParser.C \
		metScanner.C \
		../src/met/metClass.C \
		../src/templatesIGENMDL.C  \
		../src/templatesDM.C  \
		../src/templatesPCV.C  \
		../src/templatesUI.C  \
		../src/templatesUIWASHG.C  \
                ../src/met/mdl.C

IGEN_GEN_SRCS =	dataManager.thread.C \
		dataManager.thread.CLNT.C \
		dataManager.thread.SRVR.C \
		performanceConsultant.thread.C \
		performanceConsultant.thread.CLNT.C \
		performanceConsultant.thread.SRVR.C \
		dyninstRPC.xdr.C \
		dyninstRPC.xdr.CLNT.C \
		visi.xdr.CLNT.C \
		visi.xdr.C \
		VISIthread.thread.C \
		VISIthread.thread.SRVR.C \
		VISIthread.thread.CLNT.C \
		UI.thread.C \
		UI.thread.CLNT.C \
		UI.thread.SRVR.C \
		VM.thread.C \
		VM.thread.SRVR.C \
		VM.thread.CLNT.C 

	

IGEN_ISRCS    = dataManager.I \
		performanceConsultant.I \
		dyninstRPC.I \
		visi.I \
		VISIthread.I \
		UI.I \
		VM.I


TCL_SRCS	= $(wildcard ../tcl/*.tcl)
#TCL_SRCS	=
		
SRCS		+= $(TCL2C_GEN_SRCS)


IFLAGS       += -DPARADYN

LIBS 	     += -lpdutil -lpdthread
#SYSLIBS	     += -ltix -ltk -ltcl -lX11 -lm -lfl
SYSLIBS	     += -ltk -ltcl -lX11 -lm -lfl

CFLAGS       += -DNO_MDL_PRINT
CXXFLAGS     += -DNO_MDL_PRINT
TFLAGS       += -DNO_MDL_PRINT

all:	$(TARGET) 

templatesIGENMDL.o: ../src/templatesIGENMDL.C
	$(CXX) $(TFLAGS) -c ../src/templatesIGENMDL.C
templatesDM.o: ../src/templatesDM.C
	$(CXX) $(TFLAGS) -c ../src/templatesDM.C
templatesPCV.o: ../src/templatesPCV.C
	$(CXX) $(TFLAGS) -c ../src/templatesPCV.C
templatesUI.o: ../src/templatesUI.C
	$(CXX) $(TFLAGS) -c ../src/templatesUI.C

$(TCL2C_GEN_SRCS):	$(TCL_SRCS)
	perl $(TCL2C) $^ > $@


